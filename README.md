# YMC Multi-omics Analysis

## Introduction

This repository contains the core code of our analysis. It includes:
1. Singular value decomposition (SVD) of each omics data matrix. 
2. The polarization sample- and molecule-eigenvectors by sorting their loadings.
3. The enrichment analysis on the polarized gene-eigenvectors of the transcriptome.
4. The alignment of oxygen concentration curves of different omics datasets by DDTW.
5. The computation of time differences between different omics datasets.
6. Other results.

**Note**: This pipeline provides a general computational framework applicable to other data integration problems.

### Code language

All code in this repository is based on `R`.

### Usage

```bash
cd code
bash run.sh
```
All computational results can be found in the `results` directory generated.

## Directory Description

- ### `code` directory

  * **`run.sh`**  
  This script is used for running other scripts all in sequence.

  * **`config.yaml`**  
  This is the configuration file that contains basic information about datasets and script parameters.

  * **`data_process.R`**
  This script reads the data matrices of the transcriptome, metabolome, and epigenome, and prepares them for the following analysis.

  * **`matrix_decomposition.R` & `matrix_decomposition_metabolic.R`**  
  This script performs singular value decomposition(SVD) on data matrices and obtains singular values and the polarized molecule- and sample-eigenvectors. These are saved in `results` directory.

  * **`gene_enrichment_analysis.R` & `format_enrichment_result.R`**  
  This script performs the gene set enrichment analysis by the Wilcoxon scoring method on the polarized gene eigenvector. The enrichment result is saved in `results` directory.

  * **`enrichment_utils.R`**  
  This script contains functions used to perform enrichment analysis.

- ### `data` directory

  * **`pathway`** directory  
    It contains the pathway data for [GO](https://geneontology.org/) (GO.BP, GO.CC, and GO.MF), [KEGG](https://www.kegg.jp/), and [Reactome](https://reactome.org/).

  * **`microarray.csv` & `rnaseq14.csv`**  
    They are the gene expression profiles for the transcriptome. The microarray data were downloaded from the GEO repository under accession number GSE3431 and normalized by sub-sub normalization. The RNA-seq sequencing reads were downloaded from the GEO repository under accession number GSE52339. 

  * **`H*.csv`**  
    They are the histone binding strength matrices for the epigenome. Histone modifications were identified using antibodies against eight marks: H3K4me3, H3K9ac, H3K14ac, H3K18ac, H3K36me3, H3K56ac, H4K5ac, and H4K16ac. The H3 served as a reference. The raw data were downloaded from the GEO repository under accession numbers GSE52339 and GSE118889.

  * **`Metabolite_*.csv`**  
    They are the metabolite intracellular concentrations for metabolome. They represent the original datasets that were measured from methods GC-TOFMS and LC-MS, respectively, as well as the data after linear interpolation that mapped the GC-TOFMS data to LC-MS, or from LC-MS to GC-TOFMS.

  * **`annotation_SGD.tsv`**   
    It is the annotation file of yeast genes. It is used to converse among Ensembl id, Entrez id, gene symbol, and gene title.

- ### `figures` directory

This folder contains many of the figures in our analysis. All figures are plotted by `R`.

- ### `results` directory

This folder contains some of the results generated by the `code` directory

##  Contact

Please contact wanglinting@amss.ac.cn for any questions.


